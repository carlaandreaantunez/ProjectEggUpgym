<!DOCTYPE html>
<!-- <html lang="en"> -->
<html lang="es" class="h-100" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org" 
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

    <head>
        <!-- Required meta tags-->
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta name="description" content="Colorlib Templates">
        <meta name="author" content="Colorlib">
        <meta name="keywords" content="Colorlib Templates">

        <!-- Title Page-->
        <title>Registro de Usuario</title>
        <link rel="shortcut icon" th:href="@{/imagenes/logos/logo_paginas.png}">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet"
              integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css">

        <link href='https://unpkg.com/boxicons@2.0.7/css/boxicons.min.css' rel='stylesheet'>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet"
              integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css">
        <link rel="stylesheet" th:href="@{/css/carousel.css}" />
        <link rel="canonical" href="https://getbootstrap.com/docs/5.0/examples/carousel/">


        <!-- Icons font CSS-->
        <link th:href="@{/vendor/mdi-font/css/material-design-iconic-font.min.css}" rel="stylesheet" media="all">
        <link th:href="@{/vendor/font-awesome-4.7/css/font-awesome.min.css}" rel="stylesheet" media="all">
        <!-- Font special for pages-->
        <link
            href="https://fonts.googleapis.com/css?family=Poppins:100,100i,200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i"
            rel="stylesheet">
        <link rel="canonical" href="https://getbootstrap.com/docs/5.0/examples/checkout/"/>
        <!-- Vendor CSS-->
        <link th:href="@{/vendor/select2/select2.min.css}" rel="stylesheet" media="all">
        <link th:href="@{/vendor/datepicker/daterangepicker.css}" rel="stylesheet" media="all">

        <!-- Main CSS-->
        <link th:href="@{/css/formulario.css}" rel="stylesheet" media="all">

    </head>


    <body>
<header>
    <nav th:replace="fragments :: navbar"></nav>
  </header>

        <div sec:authorize="!hasRole('ADMIN')" class="page-wrapper bg-gra-02 p-t-182 p-b-100 font-poppins">
            <div class="wrapper wrapper--w780">
                <div class="card card-3">
                    <div class="card-heading"></div>
                    <div class="card-body">
                        <h2 class="title">REGISTRO</h2>
                        <form id="formulario" th:action="@{/usuarios/__${action}__}" method="POST" th:object="${usuario}" autocomplete="on"
                              enctype="multipart/form-data" novalidate>
                            <div class="input-group">

                                <input class="input--style-3" type="number" placeholder="DNI" name="dni" th:field="*{dni}" required th:readonly="${usuario.dni != null}">

                            </div>
                            <div class="input-group">
                                <input class="input--style-3" type="text" placeholder="Nombre" name="nombre" th:field="*{nombre}" required>
                            </div>
                            <div class="input-group">
                                <input class="input--style-3" type="text" placeholder="Apellido" name="apellido" th:field="*{apellido}" required>
                            </div>
                            <div class="input-group">
                                <input class="input--style-3" type="number" placeholder="Telefono" name="telefono" th:field="*{telefono}" required>
                            </div>

                            <input id="direccion" class="input--style-3" type="hidden" name="direccion"
                                   th:field="*{direccion.id}">

                            <div class="input-group rs-select2 js-select-simple select--no-search ">
                                <select name="provincia" id="provincias" class="form-select" aria-label="Elegir Provincia"
                                        th:field="*{direccion.provincia}" required>
                                    <option value="" disabled selected>Elegir Provincia</option>
                                    <option value="Buenos Aires">Buenos Aires</option>
                                    <option value="Catamarca">Catamarca</option>
                                    <option value="Chaco">Chaco</option>
                                    <option value="Chubut">Chubut</option>
                                    <option value="Cordoba">Córdoba</option>
                                    <option value="Corrientes">Corrientes</option>
                                    <option value="Entre Ríos">Entre Ríos</option><!-- nofunciona -->
                                    <option value="Formosa">Formosa</option>
                                    <option value="Jujuy">Jujuy</option>
                                    <option value="La Pampa">La Pampa</option>
                                    <option value="La Rioja">La Rioja</option>
                                    <option value="Mendoza">Mendoza</option>
                                    <option value="Misiones">Misiones</option>
                                    <option value="Neuquen">Neuquén</option>
                                    <option value="Rio Negro">Río Negro</option>
                                    <option value="Salta">Salta</option>
                                    <option value="San Juan">San Juan</option>
                                    <option value="San Luis">San Luis</option>
                                    <option value="santa cruz">Santa Cruz</option><!-- nofunciona -->
                                    <option value="Santa Fe">Santa Fe</option>
                                    <option value="Santiago del Estero">Santiago del Estero</option><!-- nofunciona -->
                                    <option value="Tierra del Fuego">Tierra del Fuego</option>
                                    <option value="Tucuman">Tucumán</option>
                                </select>
                                <div class="select-dropdown"></div>
                            </div>
                            <div class="input-group rs-select2 js-select-simple select--no-search">
                                <select name="ciudad" id="municipios" class="form-select"  aria-label="Elegir Ciudad" th:field="*{direccion.ciudad}" required>
                                    <option value="" disabled selected>Elegir Ciudad</option>
                                    <option value="ciudad1">Ciudad1</option>
                                </select>
                                <div class="select-dropdown"></div>
                            </div>               
                            <div class="input-group">
                                <input class="input--style-3" type="text" placeholder="Dirección" name="dirección" th:field="*{direccion.calleNro}" required>
                            </div>
                            <div class="input-group">


                                <input class="input--style-3" type="text" placeholder="Email" name="username" th:field="*{email}" required th:readonly="${usuario.dni!=null}">

                            </div>
                            <div class="input-group">
                                <input class="input--style-3" type="password" placeholder="Clave" name="password" th:field="*{clave}" required>
                            </div>

                            <div class="input-group">
                                <label class="input--style-3" for="imagen">Cargar Imagen</label>
                                <input class="input--style-3" type="file" accept="image/*" name="file" id="imagen">

                            </div>

                            <input id="estado" class="input--style-3" type="hidden" name="estado"
                                   th:field="*{estado}">

                            <div class="card card-3">
                                <div>
                                    <div class="p-t-10">
                                        <STYLE>A {text-decoration: none;} </STYLE><a role="button" class="btn2 btn--pill btn--azul" th:href="@{/}" > Volver </a>
                                    </div >
                                </div >
                                <div class="card-body3">
                                    <div class="p-t-10">
                                        <button class="btn2 btn--pill btn--green" type="submit">Guardar</button>
                                    </div>
                                </div>
                            </div>

                        </form>
                    </div>
                </div>
            </div>
        </div>
        
         <div  sec:authorize="hasRole('ADMIN')" class="page-wrapper bg-gra-02 p-t-182 p-b-100 font-poppins">
            <div class="wrapper wrapper--w780">
                <div class="card card-3">
                    <div class="card-heading"></div>
                    <div class="card-body">
                        <h2 class="title">REGISTRO</h2>
                        <form id="formulario" th:action="@{/usuarios/__${action}__}" method="POST" th:object="${usuario1}" autocomplete="on"
                              enctype="multipart/form-data" novalidate>
                            <div class="input-group">

                                <input class="input--style-3" type="number" placeholder="DNI" name="dni" th:field="*{dni}" required th:readonly="${usuario1.dni != null}">

                            </div>
                            <div class="input-group">
                                <input class="input--style-3" type="text" placeholder="Nombre" name="nombre" th:field="*{nombre}" required>
                            </div>
                            <div class="input-group">
                                <input class="input--style-3" type="text" placeholder="Apellido" name="apellido" th:field="*{apellido}" required>
                            </div>
                            <div class="input-group">
                                <input class="input--style-3" type="number" placeholder="Telefono" name="telefono" th:field="*{telefono}" required>
                            </div>

                            <input id="direccion" class="input--style-3" type="hidden" name="direccion"
                                   th:field="*{direccion.id}">

                            <div class="input-group rs-select2 js-select-simple select--no-search ">
                                <select name="provincia" id="provincias" class="form-select" aria-label="Elegir Provincia"
                                        th:field="*{direccion.provincia}" required>
                                    <option value="" disabled selected>Elegir Provincia</option>
                                    <option value="Buenos Aires">Buenos Aires</option>
                                    <option value="Catamarca">Catamarca</option>
                                    <option value="Chaco">Chaco</option>
                                    <option value="Chubut">Chubut</option>
                                    <option value="Cordoba">Córdoba</option>
                                    <option value="Corrientes">Corrientes</option>
                                    <option value="Entre Ríos">Entre Ríos</option><!-- nofunciona -->
                                    <option value="Formosa">Formosa</option>
                                    <option value="Jujuy">Jujuy</option>
                                    <option value="La Pampa">La Pampa</option>
                                    <option value="La Rioja">La Rioja</option>
                                    <option value="Mendoza">Mendoza</option>
                                    <option value="Misiones">Misiones</option>
                                    <option value="Neuquen">Neuquén</option>
                                    <option value="Rio Negro">Río Negro</option>
                                    <option value="Salta">Salta</option>
                                    <option value="San Juan">San Juan</option>
                                    <option value="San Luis">San Luis</option>
                                    <option value="santa cruz">Santa Cruz</option><!-- nofunciona -->
                                    <option value="Santa Fe">Santa Fe</option>
                                    <option value="Santiago del Estero">Santiago del Estero</option><!-- nofunciona -->
                                    <option value="Tierra del Fuego">Tierra del Fuego</option>
                                    <option value="Tucuman">Tucumán</option>
                                </select>
                                <div class="select-dropdown"></div>
                            </div>
                            <div class="input-group rs-select2 js-select-simple select--no-search">
                                <select name="ciudad" id="municipios" class="form-select"  aria-label="Elegir Ciudad" th:field="*{direccion.ciudad}" required>
                                    <option value="" disabled selected>Elegir Ciudad</option>
                                    <option value="ciudad1">Ciudad1</option>
                                </select>
                                <div class="select-dropdown"></div>
                            </div>               
                            <div class="input-group">
                                <input class="input--style-3" type="text" placeholder="Dirección" name="dirección" th:field="*{direccion.calleNro}" required>
                            </div>
                            <div class="input-group">


                                <input class="input--style-3" type="text" placeholder="Email" name="username" th:field="*{email}" required th:readonly="${usuario1.dni!=null}">

                            </div>
                            <div class="input-group">
                                <input class="input--style-3" type="password" placeholder="Clave" name="password" th:field="*{clave}" required>
                            </div>

                            <div class="input-group">
                                <label class="input--style-3" for="imagen">Cargar Imagen</label>
                                <input class="input--style-3" type="file" accept="image/*" name="file" id="imagen">

                            </div>

                            <input id="estado" class="input--style-3" type="hidden" name="estado"
                                   th:field="*{estado}">

                            <div class="card card-3">
                                <div>
                                    <div sec:authorize="!hasAnyRole('USUARIO,ADMIN,GIMNASIO')"  class="p-t-10">
                                        <STYLE>A {text-decoration: none;} </STYLE><a role="button" class="btn2 btn--pill btn--azul" th:href="@{/login/elegir}" > Volver </a>
                                    </div >
                                    <div sec:authorize="hasAnyRole('USUARIO,ADMIN,GIMNASIO')"  class="p-t-10">
                                        <STYLE>A {text-decoration: none;} </STYLE><a role="button" class="btn2 btn--pill btn--azul" th:href="@{/}" > Volver </a>
                                    </div >
                                </div >
                                <div class="card-body3">
                                    <div class="p-t-10">
                                        <button class="btn2 btn--pill btn--green" type="submit">Guardar</button>
                                    </div>
                                </div>
                            </div>

                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- Jquery JS-->
        <script th:src="@{/vendor/jquery/jquery.min.js}"></script>
        <!-- Vendor JS-->
        <script th:src="@{/vendor/select2/select2.min.js}"></script>
        <script th:src="@{/vendor/datepicker/moment.min.js}"></script>
        <script th:src="@{/vendor/datepicker/daterangepicker.js}"></script>

        <!-- Main JS-->
        <script th:src="@{/js/global.js}"></script>

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js"
                integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf"
        crossorigin="anonymous"></script>
        <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
        <script>
            (() => {
            "use strict";

            const form = document.getElementById("formulario");
            form.addEventListener("submit", (event) => {
            if (!form.checkValidity()) {
            event.preventDefault();
            event.stopPropagation();
            Swal.fire(
            'Debe completar todos sus datos',
            'Recuerde volver a ingresar la contraseña',
            'question'
            )
            }

            form.classList.add("was-validated");
            }, false)
            })();
        </script>
        <script>
            const selectMunicipios = $("#municipios");
            const provincias = $("#provincias");

            // buscarProvincias(provincias.value);

            provincias.change(() => buscarProvincias(provincias.val()));
            provincias.change();
            //provincias.addEventListener("change", () => buscarProvincias(provincias.value));

            async function buscar(provincia) {
            const url = `https://apis.datos.gob.ar/georef/api/municipios?provincia=${provincia}&campos=nombre&max=200&orden=nombre`;
            const response = await fetch(url);
            return response.json();
            }

            function buscarProvincias(provincia) {
            /*  selectMunicipios.innerHTML = ""; */
            selectMunicipios.val(null).trigger('change');
            selectMunicipios.html("");


            buscar(provincia).then(data => {
            for (const municipio of data["municipios"]) {
            /*   const option = document.createElement("option");
            option.value = municipio["nombre"];
            option.innerText = municipio["nombre"];
            selectMunicipios.appendChild(option); */
            // create the option and append to Select2
            var option = new Option(municipio.nombre, municipio.nombre, false, false);
            selectMunicipios.append(option).trigger('change');


            }
            });
            }
        </script>

        <footer th:replace="fragments :: footer"></footer>
    </body>

</html>
